# ЛИДЕРЫ ЦИФРОВОЙ ТРАНСФОРМАЦИИ 2023
ЗАДАЧА 5.
ПОИСК ОДИНАКОВЫХ ТОВАРОВ НА МАРКЕТПЛЕЙСЕ
https://leaders2023.innoagency.ru/task_5.html

# Порядок работы

1. В файле data_process.py задать путь к данным DATASET_PATH и WORK_PATH (сабмиты будут складываться в каталог WORK_PATH\predictions).
2. Для определения языка в каталог DATASET_PATH положить файл lid.176.bin
3. В файле requirements.txt необходимые модули для работы.
4. Для подготовки данных запустить скрипт 0_process_data.py (Для комфортной работы ОЗУ не менее 32Г).
5. Предобработанные данные для классификатора https://www.kaggle.com/datasets/saspav/ozon-task-five
6. Классификатор:
  - Локальная версия CatBoostClassifier: ozon_catboost.py 
  - Локальная версия LGBMClassifier: ozon_lightgbm.py (с ним результат пониже)
  - Запустить Jupyter Notebook ozon-catboost.ipynb https://www.kaggle.com/code/awesomesp68/ozon-catboost-2

Использованные фичи:
•	Объединены ембендинги для наименования и основной картинки.
•	К каждой записи добавлено количество товара по категориям «3» и «4».
•	Добавлена колонка с нормализованным текстом: удалены знаки препинания и выполнена токенизация модулем NLTK.
•	Из нормализованного текста получены колонки:
o	Стемминг нормализованного текста
o	Лемматизация нормализованного текста
•	Их колонки с атрибутами товара все значения были соединены в одну строку, выполнена нормализация и стемминг.
•	Добавлены колонки с количеством слов в наименовании товара и атрибутами.
•	Посчитана частотная характеристика использования атрибутов товара, добавлены 99 наиболее часто используемых атрибутов.
•	Пропуски эмбендингов в дополнительных картинках были заполнены эмбендингом основной картинки товара.
•	Посчитаны косинусные расстояния между колонками с эмбендингами.
•	Посчитано расстояние Левенштейна между колонками текстом: наименование товара и поля с атрибутами товара.
•	Для дополнительных картинок были выявлены наиболее похожие пары картинок и выделены в отдельное поле.
•	Для дополнительных картинок выделены косинусные расстояния: минимальное, среднее и максимальное.
•	Посчитан коэффициент одинаковости количества слов в тексте по формуле: 
Koeff  = 1 - abs(a - b) / max(a, b)
•	Выполнено сравнение атрибутов товара по содержимому и количеству.
•	Построено распределение товара по категории «3», затем в обучающую выборку добавлены перевернутые пары для товара с таргетом = 1, относительная доля которого больше в тестовой выборке, чем в тренировочной для выравнивания их долей.
